\doxysection{asset.\+hpp}
\hypertarget{asset_8hpp_source}{}\label{asset_8hpp_source}\index{include/rocket/asset.hpp@{include/rocket/asset.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ ROCKETGE\_\_ASSET\_HPP}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ ROCKETGE\_\_ASSET\_HPP}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}types.hpp"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}stb\_truetype.h"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <AL/al.h>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <chrono>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <mutex>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <thread>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <GLFW/glfw3.h>}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{namespace\ }rocket\ \{}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{class\ }texture\_t\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ std::vector<uint8\_t>\ data;}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ channels;}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ GLuint\ \mbox{\hyperlink{classrocket_1_1texture__t_a58a69faa604dbb1530d76421fa9a8c83}{glid}}\ =\ 0;}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }asset\_manager\_t;}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }renderer\_2d;}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }renderer\_3d;}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ vec2i\_t\ \mbox{\hyperlink{classrocket_1_1texture__t_a88aea0fb10c2f0759ab79a7529abfddf}{size}};}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1texture__t_a9dafc6df9b7caa31c0ca394215f8ccd7}{id}};}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ texture\_t();}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \string~texture\_t();}
\DoxyCodeLine{00042\ \ \ \ \ \};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keyword}{struct\ }audio\_context\_t;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{class\ }audio\_t\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ std::shared\_ptr<audio\_context\_t>\ context;}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ ALuint\ *buffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ ALuint\ source\ =\ 0;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ std::string\ path;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }asset\_manager\_t;}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ playing\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ std::thread\ finish\_thread;}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1audio__t_ae0aac2fc77c30a3849849cbd0e1cbaf3}{id}};}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ set\_context(std::shared\_ptr<audio\_context\_t>\ context);}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrocket_1_1audio__t_aa979bd2bec6a87c6b75a028e26e131d4}{play}}(\textcolor{keywordtype}{float}\ vol\ =\ 30.f,\ \textcolor{keywordtype}{bool}\ loop\ =\ \textcolor{keyword}{false},\ std::function<\textcolor{keywordtype}{void}(audio\_t\ *)>\ on\_finish\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrocket_1_1audio__t_a7d4c5b2888d83f5056d01bbb57a706fc}{seek}}(std::chrono::milliseconds\ time);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ std::chrono::milliseconds\ \mbox{\hyperlink{classrocket_1_1audio__t_a649b0a54ea26b8c122fef284b1a0599e}{get\_time}}();}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ audio\_t();}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \string~audio\_t();}
\DoxyCodeLine{00084\ \ \ \ \ \};}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrocket_1_1text__t}{text\_t}};}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrocket_1_1renderer__2d}{renderer\_2d}};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keyword}{class\ }font\_t\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ GLuint\ glid\ =\ 0;}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ rocket::vec2i\_t\ sttex\_size\ =\ \{\ 512,\ 512\ \};}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structstbtt__bakedchar}{stbtt\_bakedchar}}\ cdata[96];}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ std::vector<uint8\_t>\ ttf\_data;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ size;}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ line\_height;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }renderer\_2d;}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }asset\_manager\_t;}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }text\_t;}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1font__t_a2d75346134891a1eb887f8e5a555cbf9}{id}};}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classrocket_1_1font__t_a0e86c5a4e741370117c4ceb1e19ff1b8}{get\_line\_height}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ std::shared\_ptr<font\_t>\ \mbox{\hyperlink{classrocket_1_1font__t_aef6c9bacb4262687bec9bcd8adc4990d}{font\_default}}(\textcolor{keywordtype}{int}\ fsize);}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ font\_t();}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ unload();}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \string~font\_t();}
\DoxyCodeLine{00119\ \ \ \ \ \};}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrocket_1_1text__t_af2f73c10dcf9ac09c1cd2a74a44fa4ba}{text\_t}}\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ size\ =\ 0.f;}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structrocket_1_1rgb__color}{rgb\_color}}\ color;}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }renderer\_2d;}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ std::shared\_ptr<font\_t>\ \mbox{\hyperlink{classrocket_1_1text__t_ad7fec8a413de683a7de9b99819fec316}{font}};}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ std::string\ \mbox{\hyperlink{classrocket_1_1text__t_afa8235bdd568ed5c50f296ddac7b0ca7}{text}};}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classrocket_1_1text__t_ad198e7dfd2271136180a97660d755a9f}{set\_size}}(\textcolor{keywordtype}{float}\ size);}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classrocket_1_1text__t_a32531c1831d9899e4a1b5d3aa156c31f}{get\_size}}();}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ vec2f\_t\ \mbox{\hyperlink{classrocket_1_1text__t_a8687586f7ea8d9ba28dec434a8989bf0}{measure}}();}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrocket_1_1text__t_af2f73c10dcf9ac09c1cd2a74a44fa4ba}{text\_t}}(std::string\ \mbox{\hyperlink{classrocket_1_1text__t_afa8235bdd568ed5c50f296ddac7b0ca7}{text}},\ \textcolor{keywordtype}{float}\ size,\ \mbox{\hyperlink{structrocket_1_1rgb__color}{rgb\_color}}\ color,\ std::shared\_ptr<font\_t>\ \mbox{\hyperlink{classrocket_1_1text__t_ad7fec8a413de683a7de9b99819fec316}{font}}\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrocket_1_1text__t_af2f73c10dcf9ac09c1cd2a74a44fa4ba}{\string~text\_t}}();}
\DoxyCodeLine{00151\ \ \ \ \ \};}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classrocket_1_1asset__manager__t_a387a4bd855d5054b0e8e4bc2c8de8032}{asset\_manager\_t}}\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ std::unordered\_map<std::shared\_ptr<texture\_t>,\ std::chrono::time\_point<std::chrono::high\_resolution\_clock>>\ textures;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ std::unordered\_map<std::shared\_ptr<audio\_t>,\ std::chrono::time\_point<std::chrono::high\_resolution\_clock>>\ audios;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ std::unordered\_map<std::shared\_ptr<font\_t>,\ std::chrono::time\_point<std::chrono::high\_resolution\_clock>>\ fonts;}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ std::thread\ cleanup\_thread;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ assetid\_t\ current\_id;}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ cleanup\_running;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ std::mutex\ asset\_mutex;}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ std::shared\_ptr<audio\_context\_t>\ audio\_context;}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ std::chrono::seconds\ cleanup\_interval;}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }std::thread;}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ cleanup();}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_a157e8e31992d491046b8c62ccf61d6a9}{load\_texture}}(std::string\ path);}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ std::shared\_ptr<texture\_t>\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_a5792954a553bca22cf2abb55c7acd1dd}{get\_texture}}(assetid\_t\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_ab9516f6fe8007f4ae9bad352eb0beb6a}{load\_audio}}(std::string\ path);}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ std::shared\_ptr<audio\_t>\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_a55c8cd0aeaed7099bad2d10d39522061}{get\_audio}}(assetid\_t\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_acf4680b3f4447c2ec0541be35accb96f}{load\_font}}(\textcolor{keywordtype}{int}\ size,\ std::string\ path);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ assetid\_t\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_ac1c78c71f2aa769d6b612965b2eb0ac1}{load\_font}}(\textcolor{keywordtype}{int}\ fsize,\ std::vector<uint8\_t>\ mem);}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ std::shared\_ptr<font\_t>\ \mbox{\hyperlink{classrocket_1_1asset__manager__t_a618287fd24ffc0bc4463520459eaf570}{get\_font}}(assetid\_t\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrocket_1_1asset__manager__t_a387a4bd855d5054b0e8e4bc2c8de8032}{asset\_manager\_t}}(std::chrono::seconds\ cleanup\_interval\ =\ std::chrono::seconds(0));}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ close();}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classrocket_1_1asset__manager__t_a387a4bd855d5054b0e8e4bc2c8de8032}{\string~asset\_manager\_t}}();}
\DoxyCodeLine{00196\ \ \ \ \ \};}
\DoxyCodeLine{00197\ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
